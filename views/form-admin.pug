doctype html
html
  head
    title Administradores | Clínica
    meta(charset='UTF-8')
    meta(name='viewport', content='width=device-width, initial-scale=1.0')

    link(rel="stylesheet", href="/styles/form-admin.css")
    link(rel="stylesheet", href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css")
    link(rel='stylesheet', href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css')

    script(src="https://code.jquery.com/jquery-3.5.1.slim.min.js")
    script(src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js")
    script(src="https://cdn.jsdelivr.net/npm/sweetalert2@10")

  body
    // Navbar
    nav.navbar.navbar-expand-lg.navbar-dark.bg-primary
      a.navbar-brand(href='/home') Clínica
      button.navbar-toggler(type='button', data-toggle='collapse', data-target='#navbarNav')
        span.navbar-toggler-icon
      .collapse.navbar-collapse#navbarNav
        ul.navbar-nav.mr-auto
          li.nav-item
            a.nav-link(href='/home')
              i.fas.fa-home.mr-1
              | Inicio
          li.nav-item
            a.nav-link(href='/pacientes')
              i.fas.fa-user-injured.mr-1
              | Pacientes
          li.nav-item
            a.nav-link(href='/profesionales')
              i.fas.fa-user-md.mr-1
              | Profesionales
          li.nav-item
            a.nav-link(href='/profesionales/consultar-refeeps')
              i.fas.fa-id-card.mr-1
              | Consulta REFEPS
          li.nav-item
            a.nav-link(href='/mi-perfil')
              i.fas.fa-user-circle.mr-1
              | Mi Perfil
        ul.navbar-nav.ml-auto
          li.nav-item
            a.nav-link(href='/auth/logout')
              i.fas.fa-sign-out-alt.mr-1
              | Cerrar sesión

    // Contenedor principal
    .container.mt-5
      .row
        // Columna izquierda - lista
        .col-md-5
          .card.shadow-sm
            .card-header.bg-secondary.text-white
              h5.mb-0
                i.fas.fa-users-cog.mr-2
                | Lista de Administradores
            .card-body
              if usuarios.length
                ul.list-group
                  each usuario in usuarios
                    li.list-group-item
                      strong #{usuario.email}
              else
                p.text-muted No hay administradores registrados.

        // Columna derecha - formulario
        .col-md-7
          .card.shadow-sm
            .card-header.bg-success.text-white
              h5.mb-0
                i.fas.fa-user-plus.mr-2
                | Crear Nuevo Administrador
            .card-body
              form#formAdmin(action="/usuarioAdmin/crear-admin" method="POST")
                .form-group
                  label(for="email") Email
                  input#email.form-control(type="email", name="email", placeholder="correo@gmail.com" required)
                .form-group
                  label(for="password") Contraseña
                  input#password.form-control(type="password", name="password", placeholder="**********" required)
                button.btn.btn-success.btn-block(type="submit")
                  i.fas.fa-save.mr-1
                  | Crear Admin
    if mensajeError
      script.
        Swal.fire({
          icon: 'error',
          title: 'Error',
          text: '!{mensajeError}'
        });

    if mensajeExito
      script.
        Swal.fire({
          icon: 'success',
          title: 'Éxito',
          text: '!{mensajeExito}'
        }).then(() => {
          const newURL = window.location.origin + window.location.pathname;
          window.history.replaceState({}, document.title, newURL);
        });

    script.
      document.getElementById('formAdmin').addEventListener('submit', (e) => {
        const email = document.getElementById('email').value;
        const regex = /^[^@]+@[^@]+\.[a-zA-Z]{2,}$/;

        if (!regex.test(email)) {
          e.preventDefault();
          Swal.fire({
            icon: 'warning',
            title: 'Email inválido',
            text: 'Ingresá un email con formato válido.'
          });
        } else {
          setTimeout(() => document.getElementById('formAdmin').reset(), 100);
        }
      });

